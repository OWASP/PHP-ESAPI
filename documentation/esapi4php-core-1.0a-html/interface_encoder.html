<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ESAPI for PHP Core: Encoder Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Encoder Interface Reference</h1><!-- doxytag: class="Encoder" -->
<p>Inherited by <a class="el" href="class_default_encoder.html">DefaultEncoder</a>.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a61853ca4bb392fac8026eb5937fa3675">canonicalize</a> ($input, $strict=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a7d252af479b6e98ea11a780ab3b4e9b0">normalize</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a5cb7312cac6cac755b23e4d275f22086">encodeForCSS</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#aeeb9f50c24fde0510e357cb193fc64f5">encodeForHTML</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a4c7b6f2ccc9c58530c2271440231697b">encodeForHTMLAttribute</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#ac6b349ae03ccfade6ee07dee40b66cc2">encodeForJavaScript</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a6500382669bbf65460aa1366e17e2943">encodeForVBScript</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a009f08bb34745c665bb5f841c7940032">encodeForSQL</a> ($codec, $input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a3f38e6ab2454a753d38a55529b05be28">encodeForOS</a> ($codec, $input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a9563cc7cea9c98505deeaa74794ebc94">encodeForLDAP</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#ae4399bcdcc8308ec20f5c94fc67f83e1">encodeForDN</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#aaf2513e1aa409286dc6731a5dab07a20">encodeForXPath</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a33f152642495731bd40894fe538e9de7">encodeForXML</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#acb330e1ab1dbc8d77f531724f01bc3ca">encodeForXMLAttribute</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#abb122e0f19181f45feb982d8473c540e">encodeForURL</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a924ef330b42dc0ebcb4dfa1bdbaa0165">decodeFromURL</a> ($input)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#ac480e12011445d1fcc1ed708f472c401">encodeForBase64</a> ($input, $wrap=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_encoder.html#a83f8b04b2d3df8df7f7dc35de35c59b1">decodeFromBase64</a> ($input)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>OWASP Enterprise Security API (<a class="el" href="class_e_s_a_p_i.html">ESAPI</a>)</p>
<p>This file is part of the Open Web Application Security Project (OWASP) Enterprise Security API (<a class="el" href="class_e_s_a_p_i.html">ESAPI</a>) project. For details, please see <a href="http://www.owasp.org/index.php/ESAPI">http://www.owasp.org/index.php/ESAPI</a>.</p>
<p>Copyright (c) 2007 - 2009 The OWASP Foundation</p>
<p>The <a class="el" href="class_e_s_a_p_i.html">ESAPI</a> is published by OWASP under the BSD license. You should read and accept the LICENSE before you use, modify, and/or redistribute this software.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Linden Darling <a href="http://www.jds.net.au">JDS Australia</a>  2009 </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6 The <a class="el" href="interface_encoder.html">Encoder</a> interface contains a number of methods for decoding input and encoding output so that it will be safe for a variety of interpreters. To prevent double-encoding, all encoding methods should first check to see that the input does not already contain encoded characters. There are a few methods related to decoding that are used for canonicalization purposes. See the <a class="el" href="interface_validator.html">Validator</a> class for more information as the Validators rely heavily on these decoders for canonicalizing data before validating it. </dd></dl>
<div align="center">
<img src="doc-files/Encoder.jpg" alt="Encoder.jpg"/>
</div>
 <p>All of the methods must use a "whitelist" or "positive" security model. For the encoding methods, this means that all characters should be encoded, except for a specific list of "immune" characters that are known to be safe. For the decoding methods, all encoded characters should be decoded and if any doubly encoded characters (using the same encoding scheme or two different encoding schemes) should be rejected.</p>
<dl class="author"><dt><b>Author:</b></dt><dd></dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.4 </dd></dl>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a61853ca4bb392fac8026eb5937fa3675"></a><!-- doxytag: member="Encoder::canonicalize" ref="a61853ca4bb392fac8026eb5937fa3675" args="($input, $strict=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">canonicalize </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>strict</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Standard character sets Password character set, is alphanumerics (without l, i, I, o, O, and 0) selected specials like + (bad for URL encoding, | is like i and 1, etc...) This method performs canonicalization on data received to ensure that it has been reduced to its most basic form before validation. For example, URL-encoded data received from ordinary "application/x-www-url-encoded" forms so that it may be validated properly. </p>
<p>Canonicalization is simply the operation of reducing a possibly encoded string down to its simplest form. This is important, because attackers frequently use encoding to change their input in a way that will bypass validation filters, but still be interpreted properly by the target of the attack. Note that data encoded more than once is not something that a normal user would generate and should be regarded as an attack. </p>
<p>For input that comes from an HTTP servlet request, there are generally two types of encoding to be concerned with. The first is "applicaton/x-www-url-encoded" which is what is typically used in most forms and URI's where characters are encoded in a xy format. The other type of common character encoding is HTML entity encoding, which uses several formats: </p>
<pre>&lt;</pre><p>, </p>
<pre>&amp;#117;</pre><p>, and </p>
<pre>&amp;x3a;</pre><p>. </p>
<p>Note that all of these formats may possibly render properly in a browser without the trailing semicolon. </p>
<p>Double-encoding is a particularly thorny problem, as applying ordinary decoders may introduce encoded characters, even characters encoded with a different encoding scheme. For example 26lt; is a &lt; character which has been entity encoded and then the first character has been url-encoded. Implementations should throw an <a class="el" href="class_intrusion_exception.html">IntrusionException</a> when double-encoded characters are detected. </p>
<p>Note that there is also "multipart/form" encoding, which allows files and other binary data to be transmitted. Each part of a multipart form can itself be encoded according to a "Content-Transfer-Encoding" header. See the HTTPUtilties.getSafeFileUploads() method. </p>
<p>For more information on form encoding, please refer to the <a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a>.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to canonicalize </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>strict</em>&nbsp;</td><td>true if checking for double encoding is desired, false otherwise</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a String containing the canonicalized text</dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="class_encoding_exception.html">EncodingException</a></em>&nbsp;</td><td>if canonicalization fails </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a61853ca4bb392fac8026eb5937fa3675">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a83f8b04b2d3df8df7f7dc35de35c59b1"></a><!-- doxytag: member="Encoder::decodeFromBase64" ref="a83f8b04b2d3df8df7f7dc35de35c59b1" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">decodeFromBase64 </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode data encoded with BASE-64 encoding.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the Base64 text to decode</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input decoded from Base64</dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>IOException</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a83f8b04b2d3df8df7f7dc35de35c59b1">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a924ef330b42dc0ebcb4dfa1bdbaa0165"></a><!-- doxytag: member="Encoder::decodeFromURL" ref="a924ef330b42dc0ebcb4dfa1bdbaa0165" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">decodeFromURL </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode from URL. Implementations should first canonicalize and detect any double-encoding. If this check passes, then the data is decoded using URL decoding.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to decode from an encoded URL</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the decoded URL value</dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="class_encoding_exception.html">EncodingException</a></em>&nbsp;</td><td>if decoding fails </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a924ef330b42dc0ebcb4dfa1bdbaa0165">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="ac480e12011445d1fcc1ed708f472c401"></a><!-- doxytag: member="Encoder::encodeForBase64" ref="ac480e12011445d1fcc1ed708f472c401" args="($input, $wrap=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForBase64 </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>wrap</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode for Base64.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for Base64 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wrap</em>&nbsp;</td><td>the encoder will wrap lines every 64 characters of output</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for Base64 </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#ac480e12011445d1fcc1ed708f472c401">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a5cb7312cac6cac755b23e4d275f22086"></a><!-- doxytag: member="Encoder::encodeForCSS" ref="a5cb7312cac6cac755b23e4d275f22086" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForCSS </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in Cascading Style Sheets (CSS) content.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3.org/TR/CSS21/syndata.html#escaped-characters">CSS Syntax [w3.org]</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for CSS</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for CSS </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a5cb7312cac6cac755b23e4d275f22086">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="ae4399bcdcc8308ec20f5c94fc67f83e1"></a><!-- doxytag: member="Encoder::encodeForDN" ref="ae4399bcdcc8308ec20f5c94fc67f83e1" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForDN </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an LDAP distinguished name.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for an LDAP distinguished name</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in an LDAP distinguished name </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#ae4399bcdcc8308ec20f5c94fc67f83e1">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="aeeb9f50c24fde0510e357cb193fc64f5"></a><!-- doxytag: member="Encoder::encodeForHTML" ref="aeeb9f50c24fde0510e357cb193fc64f5" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForHTML </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in HTML using HTML entity encoding </p>
<p>Note that the following characters: 00–08, 0B–0C, 0E–1F, and 7F–9F </p>
<p>cannot be used in HTML.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://en.wikipedia.org/wiki/Character_encodings_in_HTML">HTML Encodings [wikipedia.org]</a> </dd>
<dd>
<a href="http://www.w3.org/TR/html4/sgml/sgmldecl.html">SGML Specification [w3.org]</a> </dd>
<dd>
<a href="http://www.w3.org/TR/REC-xml/#charsets">XML Specification [w3.org]</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for HTML</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for HTML </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#aeeb9f50c24fde0510e357cb193fc64f5">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a4c7b6f2ccc9c58530c2271440231697b"></a><!-- doxytag: member="Encoder::encodeForHTMLAttribute" ref="a4c7b6f2ccc9c58530c2271440231697b" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForHTMLAttribute </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in HTML attributes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for an HTML attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use as an HTML attribute </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a4c7b6f2ccc9c58530c2271440231697b">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="ac6b349ae03ccfade6ee07dee40b66cc2"></a><!-- doxytag: member="Encoder::encodeForJavaScript" ref="ac6b349ae03ccfade6ee07dee40b66cc2" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForJavaScript </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for insertion inside a data value in JavaScript. Putting user data directly inside a script is quite dangerous. Great care must be taken to prevent putting user data directly into script code itself, as no amount of encoding will prevent attacks there.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for JavaScript</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in JavaScript </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#ac6b349ae03ccfade6ee07dee40b66cc2">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a9563cc7cea9c98505deeaa74794ebc94"></a><!-- doxytag: member="Encoder::encodeForLDAP" ref="a9563cc7cea9c98505deeaa74794ebc94" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForLDAP </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in LDAP queries.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for LDAP</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in LDAP </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a9563cc7cea9c98505deeaa74794ebc94">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a3f38e6ab2454a753d38a55529b05be28"></a><!-- doxytag: member="Encoder::encodeForOS" ref="a3f38e6ab2454a753d38a55529b05be28" args="($codec, $input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForOS </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>codec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode for an operating system command shell according to the selected codec (appropriate codecs include the <a class="el" href="class_windows_codec.html">WindowsCodec</a> and <a class="el" href="class_unix_codec.html">UnixCodec</a>).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>codec</em>&nbsp;</td><td>a <a class="el" href="class_codec.html">Codec</a> that declares which operating system 'input' is being encoded for (ie. Windows, Unix, etc.) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for the command shell</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in command shell </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a3f38e6ab2454a753d38a55529b05be28">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a009f08bb34745c665bb5f841c7940032"></a><!-- doxytag: member="Encoder::encodeForSQL" ref="a009f08bb34745c665bb5f841c7940032" args="($codec, $input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForSQL </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>codec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode input for use in a SQL query, according to the selected codec (appropriate codecs include the <a class="el" href="class_my_s_q_l_codec.html">MySQLCodec</a> and <a class="el" href="class_oracle_codec.html">OracleCodec</a>).</p>
<p>This method is not recommended. The use of the PreparedStatement interface is the preferred approach. However, if for some reason this is impossible, then this method is provided as a weaker alternative.</p>
<p>The best approach is to make sure any single-quotes are double-quoted. Another possible approach is to use the {escape} syntax described in the JDBC specification in section 1.5.6.</p>
<p>However, this syntax does not work with all drivers, and requires modification of all queries.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://java.sun.com/j2se/1.4.2/docs/guide/jdbc/getstart/statement.html">JDBC Specification</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>codec</em>&nbsp;</td><td>a <a class="el" href="class_codec.html">Codec</a> that declares which database 'input' is being encoded for (ie. MySQL, Oracle, etc.) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for SQL</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in SQL </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a009f08bb34745c665bb5f841c7940032">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="abb122e0f19181f45feb982d8473c540e"></a><!-- doxytag: member="Encoder::encodeForURL" ref="abb122e0f19181f45feb982d8473c540e" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForURL </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode for use in a URL. This method performs <a href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a> on the entire string.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for use in a URL</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in a URL</dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="class_encoding_exception.html">EncodingException</a></em>&nbsp;</td><td>if encoding fails </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#abb122e0f19181f45feb982d8473c540e">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a6500382669bbf65460aa1366e17e2943"></a><!-- doxytag: member="Encoder::encodeForVBScript" ref="a6500382669bbf65460aa1366e17e2943" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForVBScript </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for insertion inside a data value in a Visual Basic script. Putting user data directly inside a script is quite dangerous. Great care must be taken to prevent putting user data directly into script code itself, as no amount of encoding will prevent attacks there.</p>
<p>This method is not recommended as VBScript is only supported by Internet Explorer</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for VBScript</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in VBScript </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a6500382669bbf65460aa1366e17e2943">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a33f152642495731bd40894fe538e9de7"></a><!-- doxytag: member="Encoder::encodeForXML" ref="a33f152642495731bd40894fe538e9de7" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForXML </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an XML element. The implementation should follow the <a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a> from the W3C. </p>
<p>The use of a real XML parser is strongly encouraged. However, in the hopefully rare case that you need to make sure that data is safe for inclusion in an XML document and cannot use a parse, this method provides a safe mechanism to do so.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for XML</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in XML </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a33f152642495731bd40894fe538e9de7">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="acb330e1ab1dbc8d77f531724f01bc3ca"></a><!-- doxytag: member="Encoder::encodeForXMLAttribute" ref="acb330e1ab1dbc8d77f531724f01bc3ca" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForXMLAttribute </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an XML attribute. The implementation should follow the <a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a> from the W3C. </p>
<p>The use of a real XML parser is highly encouraged. However, in the hopefully rare case that you need to make sure that data is safe for inclusion in an XML document and cannot use a parse, this method provides a safe mechanism to do so.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for use as an XML attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in an XML attribute </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#acb330e1ab1dbc8d77f531724f01bc3ca">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="aaf2513e1aa409286dc6731a5dab07a20"></a><!-- doxytag: member="Encoder::encodeForXPath" ref="aaf2513e1aa409286dc6731a5dab07a20" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeForXPath </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an XPath query.</p>
<p>NB: The reference implementation encodes almost everything and may over-encode.</p>
<p>The difficulty with XPath encoding is that XPath has no built in mechanism for escaping characters. It is possible to use XQuery in a parameterized way to prevent injection.</p>
<p>For more information, refer to <a href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">this article</a> which specifies the following list of characters as the most dangerous: ^&amp;"*';&lt;&gt;(). &lt;a
 href="<a href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf</a>"&gt;This
 paper&lt;/a&gt; suggests disallowing ' and " in queries.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">XPath Injection [ibm.com]</a> </dd>
<dd>
<a href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">Blind XPath Injection [packetstormsecurity.org]</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to encode for XPath </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in XPath </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#aaf2513e1aa409286dc6731a5dab07a20">DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a7d252af479b6e98ea11a780ab3b4e9b0"></a><!-- doxytag: member="Encoder::normalize" ref="a7d252af479b6e98ea11a780ab3b4e9b0" args="($input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">normalize </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>input</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reduce all non-ascii characters to their ASCII form so that simpler validation rules can be applied. For example, an accented-e character will be changed into a regular ASCII e character.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>the text to normalize</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a normalized String </dd></dl>

<p>Implemented in <a class="el" href="class_default_encoder.html#a7d252af479b6e98ea11a780ab3b4e9b0">DefaultEncoder</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Nov 18 15:13:38 2009 for ESAPI for PHP Core by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
